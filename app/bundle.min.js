!function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}}()({1:[function(require,module,exports){let navigation=require("./user/navigation"),loginForm=require("./user/loginForm"),createUserBtn=require("./user/createUserBtn"),deleteUserBtn=require("./user/deleteUserBtn"),productList=require("./product/productList"),createProductForm=require("./product/createProductForm"),patchProductForm=require("./product/patchProductForm"),orderList=require("./order/orderList"),createOrderForm=require("./order/createOrder"),purgeOrderBtn=require("./order/purgeOrderBtn");module.exports={navigation:navigation,loginForm:loginForm,createUserBtn:createUserBtn,deleteUserBtn:deleteUserBtn,productList:productList,createProductForm:createProductForm,patchProductForm:patchProductForm,orderList:orderList,createOrderForm:createOrderForm,purgeOrderBtn:purgeOrderBtn}},{"./order/createOrder":2,"./order/orderList":3,"./order/purgeOrderBtn":4,"./product/createProductForm":5,"./product/patchProductForm":6,"./product/productList":7,"./user/createUserBtn":8,"./user/deleteUserBtn":9,"./user/loginForm":10,"./user/navigation":11}],10:[function(require,module,exports){module.exports=loginForm='\n<div id="login" class="text-center form-signin">\n    <form class="form-signin">\n        <img class="mb-4 logo-img-color" src="/static/safari-pinned-tab.svg" alt="" width="72" height="72">\n        <h1 class="h3 mb-3 font-weight-normal" id="loginTitle"></h1>\n        <label for="email" class="sr-only">Email address</label>\n        <input type="email" id="email" class="form-control" placeholder="Email address" required autofocus>\n        <label for="password" class="sr-only">Password</label>\n        <input type="password" id="password" class="form-control" placeholder="Password" required>\n        <div id="warning" class="warning"></div>\n        <div class="checkbox mb-3">\n            <label>\n                <input type="checkbox" value="remember-me"> Remember me\n            </label>\n        </div>\n        <button class="btn btn-lg btn-primary btn-block" type="submit" id="submit"></button>\n        <p class="mt-5 mb-3 text-muted">&copy; 2019</p>\n    </form>\n</div>\n'},{}],11:[function(require,module,exports){module.exports='\n<nav id="navigation" class="navbar navbar-expand-sm navbar-dark bg-dark">\n  <a class="navbar-brand" href="/">\n  <img class="logo-img-color" src="/static/safari-pinned-tab.svg" alt="" width="30" height="30">\n  </a>\n  <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample03" aria-controls="navbarsExample03" aria-expanded="false" aria-label="Toggle navigation">\n    <span class="navbar-toggler-icon"></span>\n  </button>\n  <div class="navbar-collapse collapse" id="navbarsExample03" >\n    <form class="form-inline my-2 my-md-0">\n      <input class="form-control search-height" type="text" placeholder="Search" disabled="disabled">\n    </form>\n    <ul id="user-list" class="navbar-nav ml-auto">\n      <li class="nav-item">\n        <a id="user-email" class="nav-link disabled" href=""></a>\n      </li>\n      <li class="nav-item active">\n        <a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a>\n      </li>\n      <li class="nav-item">\n        <a id="logOut" class="nav-link" href="">Log out</a>\n      </li>\n      <li class="nav-item d-none">\n        <a class="nav-link" href="#">Link</a>\n      </li>\n      <li class="nav-item d-none">\n        <a class="nav-link disabled" href="#">Disabled</a>\n      </li>\n      <li class="nav-item dropdown d-none">\n        <a class="nav-link dropdown-toggle" href="#" id="dropdown03" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>\n        <div class="dropdown-menu" aria-labelledby="dropdown03">\n          <a class="dropdown-item" href="#">Action</a>\n          <a class="dropdown-item" href="#">Another action</a>\n          <a class="dropdown-item" href="#">Something else here</a>\n        </div>\n      </li>\n    </ul>\n  </div>\n</nav>'},{}],8:[function(require,module,exports){let liItem=document.createElement("LI");liItem.classList.add("nav-item","active");let aItem=document.createElement("A");aItem.classList.add("nav-link"),aItem.setAttribute("id","createUser"),aItem.setAttribute("href","");let textnode=document.createTextNode("Create new account");liItem.appendChild(aItem),aItem.appendChild(textnode),module.exports=createUser=liItem},{}],9:[function(require,module,exports){let liItem=document.createElement("LI");liItem.classList.add("nav-item","active");let aItem=document.createElement("A");aItem.classList.add("nav-link"),aItem.setAttribute("id","deleteUser"),aItem.setAttribute("href","");let textnode=document.createTextNode("Delete my account");liItem.appendChild(aItem),aItem.appendChild(textnode),module.exports=deleteUser=liItem},{}],5:[function(require,module,exports){module.exports=createProduct='<div class="bd-example">\n        <form id="submit-product">\n            <div class="form-row align-items-center">\n                <div class="col">\n                    <label class="sr-only" for="inlineFormInput">Name</label>\n                    <input type="text" class="form-control mb-2" id="product-input-name" placeholder="Product name" required >\n                </div>\n                <div class="col-auto">\n                    <label class="sr-only" for="inlineFormInputGroup">Price</label>\n                    <div class="input-group mb-2">\n                        <div class="input-group-prepend">\n                            <div class="input-group-text">$</div>\n                        </div>\n                        <input type="number" step="0.01" min=0 class="form-control" id="product-input-price" placeholder="Price" required>\n                    </div>\n                </div>\n                <div class="col-auto">\n                    <button id="submit" type="submit" class="btn btn-primary mb-2">Submit</button>\n                </div>\n            </div>\n        </form>\n        <div id="create-product-warning" class="warning"></div>\n    </div>'},{}],2:[function(require,module,exports){module.exports=createOrderForm='\n<form id="create-order">\n  <div class="form-row align-items-center">\n    <div class="col-auto">\n      <label class="sr-only" for="inlineFormInput">Name</label>\n      <input type="text" class="form-control mb-2" id="order-create-name" placeholder="" disabled>\n    </div>\n    <div class="col-auto">\n      <label class="sr-only" for="inlineFormInputGroup">Username</label>\n      <div class="input-group mb-2">\n        <div class="input-group-prepend">\n          <div class="input-group-text">Q</div>\n        </div>\n        <input type="number" step="1" min="0" class="form-control" id="order-create-quantity" placeholder="1">\n      </div>\n    </div>\n    <div class="col-auto">\n      <button id="order-submit" type="submit" class="btn btn-primary mb-2">Submit</button>\n    </div>\n    <div class="col-auto">\n      <button id="order-cancel" type="submit" class="btn btn-outline-danger mb-2">Cancel</button>\n    </div>\n  </div>\n  <div id="create-order-warning" class="warning"></div>\n</form>'},{}],4:[function(require,module,exports){module.exports='\n<button id="orders-purge" type="submit" class="btn btn-outline-danger mb-2 d-inline-block">Purge orders</button>\n'},{}],6:[function(require,module,exports){module.exports=patchProductForm='\n<form id="patch-product">\n  <div class="form-row align-items-center">\n    <div class="col-auto">\n      <label class="sr-only" for="inlineFormInput">Name</label>\n      <input type="text" class="form-control mb-2" id="product-patch-name" placeholder="" required>\n    </div>\n    <div class="col-auto">\n      <label class="sr-only" for="inlineFormInputGroup">Username</label>\n      <div class="input-group mb-2">\n        <div class="input-group-prepend">\n          <div class="input-group-text">$</div>\n        </div>\n        <input type="number" step="0.01" min="0" class="form-control" id="product-patch-price" placeholder="" required>\n      </div>\n    </div>\n    <div class="col-auto">\n      <button id="patch-submit" type="submit" class="btn btn-primary mb-2">Submit</button>\n    </div>\n    <div class="col-auto">\n      <button id="patch-cancel" type="submit" class="btn btn-outline-danger mb-2">Cancel</button>\n    </div>\n  </div>\n  <div id="patch-product-warning" class="warning"></div>\n</form>'},{}],7:[function(require,module,exports){module.exports='\n<div id="products" class="jumbotron">\n    <h2 class="products-title">Products <span id="products-total" class="badge badge-secondary"></span></h2>\n    <div id="get-products-warning" class="warning"></div>\n    <hr id="products-title" class="my-4">\n    <ul id="products-list" class="list-group list-group-flush">\n    </ul>\n</div>'},{}],3:[function(require,module,exports){module.exports='\n<div id="orders" class="jumbotron">\n    <h2 class="orders-title d-inline-block">Orders <span id="orders-total" class="badge badge-secondary"></span></h2>\n    <div id="get-orders-warning" class="warning"></div>\n    <hr id="orders-title" class="my-4">\n    <ul id="orders-list" class="list-group list-group-flush">\n    </ul>\n</div>'},{}],12:[function(require,module,exports){module.exports={heroku:{dev:"http://127.0.0.1:3000",url:"https://sleepy-dusk.herokuapp.com"}}},{}],13:[function(require,module,exports){module.exports={resetProductValues:function(e,productItem,i,productNames,productPrices,productIds){e.preventDefault(),productItem.innerHTML=`\n    <div class="product-name">${productNames}</div>\n    <div class="product-price">$ ${productPrices}</div>\n    <img class="patch-product icon" src="/static/edit.svg">\n    <img class="order-product icon" src="/static/order.svg">\n    <img class="delete-product icon" src="/static/del.svg">`,document.getElementsByClassName("patch-product")[i].addEventListener("click",function(){let{patchProduct:patchProduct}=require("../products/patchProduct");patchProduct(i,productNames,productPrices,productIds)}),document.getElementsByClassName("delete-product")[i].addEventListener("click",function(){let{deleteProduct:deleteProduct}=require("../products/deleteProduct");confirm("Are you sure you want to delete this product?")&&deleteProduct(productIds)}),document.getElementsByClassName("order-product")[i].addEventListener("click",function(){let{createOrder:createOrder}=require("../orders/createOrder");createOrder(i,productNames,productPrices,productIds)})}}},{"../orders/createOrder":15,"../products/deleteProduct":20,"../products/patchProduct":22}],22:[function(require,module,exports){const api=require("../../config/api-settings");let{patchProductForm:patchProductForm}=require("../../components/index"),{resetProductValues:resetProductValues}=require("../commonFunctions/resetProductValues"),getUser=localStorage.getItem("token");module.exports={patchProduct:function(i,productNames,productPrices,productIds){let productItem=document.getElementsByClassName("product-item")[i];document.getElementById("product-patch-name")||(productItem.innerHTML=patchProductForm,document.getElementById("product-patch-name").value=productNames,document.getElementById("product-patch-price").value=productPrices),document.getElementById("patch-cancel").addEventListener("click",function(e){resetProductValues(e,productItem,i,productNames,productPrices,productIds)}),document.getElementById("patch-product").addEventListener("submit",function(e){e.preventDefault(),document.getElementById("patch-submit").disabled=!0;let url=api.heroku.url+"/products/"+productIds,productName=document.getElementById("product-patch-name"),productPrice=document.getElementById("product-patch-price"),warning=document.getElementById("patch-product-warning");if(warning.classList.remove("warning-pass"),productName.value.length<=5||productName.value.length>=50)return warning.innerHTML="Come on, please enter normal product name. Beetween 5 and 50 characters.",!1;if(0==productPrice.value)return warning.innerHTML="Come on, please enter normal product price. Above $0.",!1;{let product=JSON.stringify([{propName:"name",value:productName.value},{propName:"price",value:productPrice.value}]),submit=document.getElementById("patch-submit");submit.innerText="Loading...";let xhr=new XMLHttpRequest;xhr.open("PATCH",url,!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.setRequestHeader("Authorization",getUser),xhr.send(product),xhr.onload=function(){if(200===this.status){let response=JSON.parse(this.responseText),{getProducts:getProducts}=require("./getProducts"),{getOrders:getOrders}=require("./../orders/getOrders");warning.classList.add("warning-pass"),warning.innerHTML=response.message,setTimeout(()=>getProducts(),1e3),setTimeout(()=>getOrders(),1e3)}else{let response=JSON.parse(this.responseText);console.warn(response.error.message),warning.innerHTML="Ooops! Something went wrong. :( <br>Please try again later."}},submit.innerText="Submit"}})}}},{"../../components/index":1,"../../config/api-settings":12,"../commonFunctions/resetProductValues":13,"./../orders/getOrders":17,"./getProducts":21}],20:[function(require,module,exports){const api=require("../../config/api-settings");let getUser=localStorage.getItem("token");module.exports={deleteProduct:function(productIds){url=api.heroku.url+"/products/"+productIds;let warning=document.getElementById("create-product-warning");warning.classList.remove("warning-pass");let xhr=new XMLHttpRequest;xhr.open("DELETE",url,!0),xhr.setRequestHeader("Authorization",getUser),xhr.send(),xhr.onload=function(){let response=JSON.parse(this.responseText),{getProducts:getProducts}=require("./getProducts"),{getOrders:getOrders}=require("./../orders/getOrders");200===this.status?(warning.classList.add("warning-pass"),warning.innerHTML=response.message,setTimeout(()=>getProducts(),2e3),setTimeout(()=>getOrders(),2e3),setTimeout(()=>warning.innerHTML="",5e3)):warning.innerHTML="It appears that we are having some issues at the moment. Please try again later."}}}},{"../../config/api-settings":12,"./../orders/getOrders":17,"./getProducts":21}],15:[function(require,module,exports){const api=require("../../config/api-settings");let{createOrderForm:createOrderForm}=require("../../components/index"),{resetProductValues:resetProductValues}=require("../commonFunctions/resetProductValues"),getUser=localStorage.getItem("token");module.exports={createOrder:function(i,productNames,productPrices,productIds){let productItem=document.getElementsByClassName("product-item")[i];document.getElementById("order-create-name")||(productItem.innerHTML=createOrderForm,document.getElementById("order-create-name").value=productNames),document.getElementById("order-cancel").addEventListener("click",function(e){resetProductValues(e,productItem,i,productNames,productPrices,productIds)}),document.getElementById("create-order").addEventListener("submit",function(e){e.preventDefault(),document.getElementById("order-submit").disabled=!0;let url=api.heroku.url+"/orders",orderQuantity=document.getElementById("order-create-quantity"),warning=document.getElementById("create-order-warning");warning.classList.remove("warning-pass");let order={};order=orderQuantity.value?{productId:productIds,quantity:orderQuantity.value}:{productId:productIds},order=JSON.stringify(order);let submit=document.getElementById("order-submit");submit.innerText="Loading...";let xhr=new XMLHttpRequest;xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.setRequestHeader("Authorization",getUser),xhr.send(order),xhr.onload=function(){let response=JSON.parse(this.responseText),{getOrders:getOrders}=require("./getOrders");201===this.status?(warning.classList.add("warning-pass"),warning.innerHTML=response.message,setTimeout(()=>getOrders(),2e3),setTimeout(()=>resetProductValues(e,productItem,i,productNames,productPrices,productIds),2e3),setTimeout(()=>document.getElementById("get-orders-warning").innerHTML="",5e3)):(console.warn(response),warning.innerHTML="Ooops! Something went wrong. :( <br>Please try again later.")},submit.innerText="Submit"})}}},{"../../components/index":1,"../../config/api-settings":12,"../commonFunctions/resetProductValues":13,"./getOrders":17}],14:[function(require,module,exports){let logIn=require("./user/logIn"),signUp=require("./user/signUp"),deleteUser=require("./user/delete"),adminEval=require("./user/adminEval"),decodeToken=require("./user/decodeToken"),getProducts=require("./products/getProducts"),createProduct=require("./products/createProduct"),deleteProduct=require("./products/deleteProduct"),patchProduct=require("./products/patchProduct"),getOrders=require("./orders/getOrders"),createOrder=require("./orders/createOrder"),deleteOrder=require("./orders/deleteOrders"),purgeOrders=require("./orders/purgeOrders"),resetProductValues=require("./commonFunctions/resetProductValues");module.exports={logIn:logIn,signUp:signUp,deleteUser:deleteUser,adminEval:adminEval,decodeToken:decodeToken,getProducts:getProducts,createProduct:createProduct,deleteProduct:deleteProduct,patchProduct:patchProduct,getOrders:getOrders,createOrder:createOrder,deleteOrder:deleteOrder,purgeOrders:purgeOrders,resetProductValues:resetProductValues}},{"./commonFunctions/resetProductValues":13,"./orders/createOrder":15,"./orders/deleteOrders":16,"./orders/getOrders":17,"./orders/purgeOrders":18,"./products/createProduct":19,"./products/deleteProduct":20,"./products/getProducts":21,"./products/patchProduct":22,"./user/adminEval":23,"./user/decodeToken":24,"./user/delete":25,"./user/logIn":26,"./user/signUp":27}],24:[function(require,module,exports){let getUser=localStorage.getItem("token");var base64Url,base64;if(getUser){let token=getUser.split(" ")[1];module.exports=(base64Url=token.split(".")[1],base64=decodeURIComponent(atob(base64Url).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join("")),JSON.parse(base64))}},{}],25:[function(require,module,exports){let decodedToken=require("./decodeToken");const api=require("../../config/api-settings");let{deleteUserBtn:deleteUserBtn}=require("../../components/index"),logOutUser=require("../user/logIn"),getUser=localStorage.getItem("token");if(getUser){let userList=document.getElementById("user-list");userList.insertBefore(deleteUserBtn,userList.childNodes[3]),document.getElementById("deleteUser").addEventListener("click",function(e){confirm("Are you sure you want to delete your account?")&&function(e){e.preventDefault();let deleteBtn=document.getElementById("deleteUser");console.log("User: ",decodedToken.email),console.log("Id: ",decodedToken.userId);let url=api.heroku.url+"/users/"+decodedToken.userId,xhr=new XMLHttpRequest;xhr.open("DELETE",url,!0),xhr.setRequestHeader("Authorization",getUser),deleteBtn.innerHTML="Deleting...",xhr.send(),xhr.onload=function(){if(200==this.status){const response=JSON.parse(this.responseText);deleteBtn.innerHTML=response.message,logOutUser.logOut()}}}(e)})}},{"../../components/index":1,"../../config/api-settings":12,"../user/logIn":26,"./decodeToken":24}],23:[function(require,module,exports){let decodedToken=require("./decodeToken");localStorage.getItem("token")&&("5c6b3a143a5fa000172489d4"==decodedToken.userId?document.getElementById("deleteUser").remove():document.getElementById("createUser").remove())},{"./decodeToken":24}],27:[function(require,module,exports){const api=require("../../config/api-settings");let{createUserBtn:createUserBtn,loginForm:loginForm}=require("../../components/index"),login=require("../../src/user/logIn"),container=document.getElementById("container"),getUser=localStorage.getItem("token");if(getUser){let userList=document.getElementById("user-list");userList.insertBefore(createUserBtn,userList.childNodes[3]),document.getElementById("createUser").addEventListener("click",function(e){e.preventDefault(),document.getElementById("navigation").remove(),document.getElementById("products").remove(),document.getElementById("orders").remove(),container.insertAdjacentHTML("afterbegin",loginForm),document.getElementById("loginTitle").innerText="Create new profile for:",document.getElementById("submit").innerText="Create profile",document.getElementById("login").addEventListener("submit",signUp)})}function signUp(e){e.preventDefault();let submitBtn=document.getElementById("submit"),warning=document.getElementById("warning");warning.classList.remove("warning-pass");let user=JSON.stringify({email:document.getElementById("email").value,password:document.getElementById("password").value});console.log("From signup",user);let url=api.heroku.url+"/users/signup",xhr=new XMLHttpRequest;xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.setRequestHeader("Authorization",getUser),submitBtn.innerText="Loading...",xhr.send(user),xhr.onprogress=function(){submitBtn.innerText="Processing.."},xhr.onload=function(){if(201==this.status){const response=JSON.parse(this.responseText);submitBtn.innerText="Submit",warning.style.display="block",warning.classList.add("warning-pass"),warning.innerHTML=response.message,login.loginUser(e),console.log("From onload",login.loginUser)}else{submitBtn.innerText="Submit";const response=JSON.parse(this.responseText);warning.style.display="block",warning.innerHTML=response.message||response.error._message}}}},{"../../components/index":1,"../../config/api-settings":12,"../../src/user/logIn":26}],17:[function(require,module,exports){let{orderList:orderList,purgeOrderBtn:purgeOrderBtn}=require("../../components/index"),{deleteOrder:deleteOrder}=require("./deleteOrders"),{purgeOrders:purgeOrders}=require("./purgeOrders");const api=require("../../config/api-settings");let hook=document.getElementById("products"),getUser=localStorage.getItem("token");function getOrders(){let url=api.heroku.url+"/orders",xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.setRequestHeader("Authorization",getUser),xhr.onload=function(){let response=JSON.parse(this.responseText);if(200===this.status){document.getElementById("orders-total").innerHTML=response.count;let listHolder=document.getElementById("orders-list"),orderItem="",orderIds=[];for(let i=0;i<response.orders.length;i++)orderItem+=`\n                <li class="order-item list-group-item d-flex justify-content-between">\n                    <div class="order-id product-name">${response.orders[i]._id}</div>\n                    <div class="ordered-product-name">Products: ${response.orders[i].product?response.orders[i].product.name:response.orders[i].product}</div>\n                    <div class="ordered-product-quantity">Quantity: ${response.orders[i].quantity}</div>\n                    <img class="delete-order icon" src="/static/del.svg">\n                </li>`,orderIds.push(response.orders[i]._id);listHolder.innerHTML=orderItem;let deleteOrderIcon=document.querySelectorAll(".delete-order");for(let i=0;i<deleteOrderIcon.length;i++)deleteOrderIcon[i].addEventListener("click",function deleteHelper(){confirm("Are you sure you want to delete this order?")&&(deleteOrder(orderIds[i]),deleteOrderIcon[i].removeEventListener("click",deleteHelper))});let emptyOrderIds=[];for(let i=0;i<response.orders.length;i++)response.orders[i].product||emptyOrderIds.push(response.orders[i]._id);let purgeBtn=document.getElementById("orders-purge");purgeBtn&&purgeBtn.parentElement.removeChild(purgeBtn),0!=emptyOrderIds.length&&(document.getElementsByClassName("orders-title")[0].insertAdjacentHTML("afterend",purgeOrderBtn),document.getElementById("orders-purge").addEventListener("click",function(e){confirm("Are you sure you want to delete all empty orders?")&&purgeOrders(e,emptyOrderIds)}))}else document.getElementById("get-orders-warning").innerHTML="It appears that we are having some issues. :(<br>Please try again later."},xhr.send()}getUser&&(hook.insertAdjacentHTML("afterend",orderList),getOrders(),module.exports={getOrders:getOrders})},{"../../components/index":1,"../../config/api-settings":12,"./deleteOrders":16,"./purgeOrders":18}],19:[function(require,module,exports){let{createProductForm:createProductForm}=require("../../components/index"),{getProducts:getProducts}=require("./getProducts"),api=require("../../config/api-settings"),getUser=localStorage.getItem("token");getUser&&(document.getElementById("products-title").insertAdjacentHTML("afterend",createProductForm),document.getElementById("submit-product").addEventListener("submit",function(e){e.preventDefault(),document.getElementById("submit").disabled=!0;let url=api.heroku.url+"/products",productName=document.getElementById("product-input-name"),productPrice=document.getElementById("product-input-price"),warning=document.getElementById("create-product-warning");if(warning.classList.remove("warning-pass"),productName.value.length<=5||productName.value.length>=50)return warning.innerHTML="Come on, please enter normal product name. Beetween 5 and 50 characters.",!1;if(0==productPrice.value)return warning.innerHTML="Come on, please enter normal product price. Above $0.",!1;{let product=JSON.stringify({name:productName.value,price:productPrice.value}),submit=document.getElementById("submit");submit.innerText="Loading...";let xhr=new XMLHttpRequest;xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/json"),xhr.setRequestHeader("Authorization",getUser),xhr.send(product),xhr.onload=function(){if(201===this.status){let response=JSON.parse(this.responseText);productName.value="",productPrice.value="",warning.classList.add("warning-pass"),warning.innerHTML=response.message,setTimeout(()=>warning.innerHTML="",5e3),document.getElementById("get-products-warning").innerHTML="",document.getElementById("submit").disabled=!1,getProducts()}else{let response=JSON.parse(this.responseText);console.warn(response.error.message),warning.innerHTML="Ooops! Something went wrong. :( <br>Please try again later."}},submit.innerText="Submit"}}))},{"../../components/index":1,"../../config/api-settings":12,"./getProducts":21}],16:[function(require,module,exports){const api=require("../../config/api-settings");let getUser=localStorage.getItem("token");module.exports={deleteOrder:function(orderIds){url=api.heroku.url+"/orders/"+orderIds;let warning=document.getElementById("get-orders-warning");warning.classList.remove("warning-pass");let xhr=new XMLHttpRequest;xhr.open("DELETE",url,!0),xhr.setRequestHeader("Authorization",getUser),xhr.send(),xhr.onload=function(){let response=JSON.parse(this.responseText),{getOrders:getOrders}=require("./getOrders");200===this.status?(warning.classList.add("warning-pass"),warning.innerHTML=response.message,setTimeout(()=>getOrders(),2e3),setTimeout(()=>document.getElementById("get-orders-warning").innerHTML="",5e3)):warning.innerHTML="It appears that we are having some issues at the moment. Please try again later."}}}},{"../../config/api-settings":12,"./getOrders":17}],21:[function(require,module,exports){let{productList:productList}=require("../../components/index");const api=require("../../config/api-settings");let{deleteProduct:deleteProduct}=require("./deleteProduct"),{patchProduct:patchProduct}=require("./patchProduct"),{createOrder:createOrder}=require("./../orders/createOrder"),nav=document.getElementById("navigation"),getUser=localStorage.getItem("token");function getProducts(){let url=api.heroku.url+"/products",countHolder=document.getElementById("products-total"),xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.setRequestHeader("Authorization",getUser),xhr.send(),xhr.onload=function(){if(200===this.status){let response=JSON.parse(this.responseText);countHolder.innerHTML=response.count;let listHolder=document.getElementById("products-list"),productItem="",productIds=[],productNames=[],productPrices=[];for(let i=0;i<response.products.length;i++)productItem+=`\n                <li class="product-item list-group-item d-flex justify-content-between">\n                    <div class="product-name">${response.products[i].name}</div>\n                    <div class="product-price">$ ${response.products[i].price}</div>\n                    <img class="patch-product icon" src="/static/edit.svg">\n                    <img class="order-product icon" src="/static/order.svg">\n                    <img class="delete-product icon" src="/static/del.svg">\n                </li>`,productIds.push(response.products[i]._id),productNames.push(response.products[i].name),productPrices.push(response.products[i].price);listHolder.innerHTML=productItem;let deleteProductIcon=document.querySelectorAll(".delete-product"),patchProductIcon=document.querySelectorAll(".patch-product"),createOrderIcon=document.querySelectorAll(".order-product");for(let i=0;i<deleteProductIcon.length;i++)deleteProductIcon[i].addEventListener("click",function deleteSupport(){confirm("Are you sure you want to delete this product?")&&(deleteProduct(productIds[i]),deleteProductIcon[i].removeEventListener("click",deleteSupport))});for(let i=0;i<patchProductIcon.length;i++)patchProductIcon[i].addEventListener("click",function(){patchProduct(i,productNames[i],productPrices[i],productIds[i])});for(let i=0;i<createOrderIcon.length;i++)createOrderIcon[i].addEventListener("click",function(){createOrder(i,productNames[i],productPrices[i],productIds[i])})}else if(404===this.status){countHolder.innerHTML="0",document.getElementById("get-products-warning").innerHTML="It appears that there no products available. Please create some more. ;)";let productItems=document.querySelectorAll(".product-item");for(let i=0;i<productItems.length;i++)productItems[i].remove()}else document.getElementById("get-products-warning").innerHTML="It appears that there are some issues going on. :(<br> Please try again later. Thanks."}}getUser&&(nav.insertAdjacentHTML("afterend",productList),getProducts(),module.exports={getProducts:getProducts})},{"../../components/index":1,"../../config/api-settings":12,"./../orders/createOrder":15,"./deleteProduct":20,"./patchProduct":22}],18:[function(require,module,exports){const api=require("../../config/api-settings");let getUser=localStorage.getItem("token");module.exports={purgeOrders:function(e,emptyOrderIds){e.preventDefault(),document.getElementById("orders-purge").disabled=!0;let warning=document.getElementById("get-orders-warning");warning.classList.remove("warning-pass"),url=api.heroku.url+"/orders/",deleteUrl=[];for(let i=0;i<emptyOrderIds.length;i++)deleteUrl.push(url+emptyOrderIds[i]);for(let i=0;i<deleteUrl.length;i++){let xhr=new XMLHttpRequest;xhr.open("DELETE",deleteUrl[i],!0),xhr.setRequestHeader("Authorization",getUser),xhr.onload=function(){if(200===this.status){let response=JSON.parse(this.responseText);warning.classList.add("warning-pass"),warning.innerHTML=response.message}else warning.innerHTML="It appears that we are having some issues at the moment. Please try again later."},xhr.send()}let{getOrders:getOrders}=require("./getOrders");setTimeout(()=>getOrders(),2e3),setTimeout(()=>document.getElementById("get-orders-warning").innerHTML="",5e3)}}},{"../../config/api-settings":12,"./getOrders":17}],26:[function(require,module,exports){let decodedToken=require("./decodeToken");const api=require("../../config/api-settings");let{loginForm:loginForm,navigation:navigation}=require("../../components/index"),container=document.getElementById("container");if(localStorage.getItem("token")){let currentDate=Math.round((new Date).getTime()/1e3);decodedToken.exp<=currentDate&&logOut(),container.insertAdjacentHTML("afterbegin",navigation),document.getElementById("user-email").innerText=decodedToken.email,document.getElementById("logOut").addEventListener("click",logOut)}else container.insertAdjacentHTML("afterbegin",loginForm),document.getElementById("loginTitle").innerText="Please log in",document.getElementById("submit").innerText="Log in",document.getElementById("login").addEventListener("submit",loginUser),console.log("User is not logged in");function logOut(){localStorage.removeItem("token"),window.location.reload(!0)}function loginUser(e){e.preventDefault();let submitBtn=document.getElementById("submit"),warning=document.getElementById("warning"),email=document.getElementById("email").value,password=document.getElementById("password").value;if(console.log("email from sgnup: ",email),console.log("pass from sgnup: ",password),!email||!password)return alert("Please fill out the data."),!1;let regex=new RegExp(/^\S+@\S+[\.][0-9a-z]+$/);if(!email.match(regex))return alert("Please enter valid email address."),!1;let user=JSON.stringify({email:email,password:password});console.log("From login",user);let url=api.heroku.url+"/users/login",xhr=new XMLHttpRequest;xhr.open("POST",url,!0),xhr.setRequestHeader("Content-Type","application/json"),submitBtn.innerText="Loading...",xhr.send(user),xhr.onprogress=function(){submitBtn.innerText="Processing.."},xhr.onload=function(){if(200==this.status){const response=JSON.parse(this.responseText);localStorage.setItem("token",`Bearer ${response.token}`),console.log("From Local: ",localStorage.getItem("token")),submitBtn.innerText="Submit",container.removeChild(document.getElementById("login")),window.location.reload(!0)}else{submitBtn.innerText="Submit";const response=JSON.parse(this.responseText);warning.style.display="block",warning.innerHTML=response.message||response.error._message}}}module.exports={loginUser:loginUser,logOut:logOut}},{"../../components/index":1,"../../config/api-settings":12,"./decodeToken":24}]},{},[14]);
